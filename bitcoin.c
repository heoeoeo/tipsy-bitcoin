#include <stdio.h>
#include <string.h>
#include <unistd.h>
#include <math.h>
#include <stdlib.h>

#define WIDTH  80
#define HEIGHT 40
#define PI 3.14159265

char *ascii_art[] = {
    "                                      ========================                                      ",
    "                                 ==================================                                 ",
    "                            =============================================                           ",
    "                        ====================================================                        ",
    "                      ========================================================                      ",
    "                   ==============================================================                   ",
    "                 ==================================================================                 ",
    "               ======================================================================               ",
    "             ==========================================================================             ",
    "           =====================================--=======================================           ",
    "          =====================================-. ...-====================================          ",
    "         ======================================.    .====- ..:-=============================        ",
    "        ======================================-    .:====.    .-=============================       ",
    "      ============================:..::-======.    .-===:    .:===============================      ",
    "     ============================-.       ..::    .:====.    .-================================     ",
    "    =============================:.               ..::-:.    :==================================    ",
    "    =============================--:..                       -==================================    ",
    "   ====================================.                       .:-===============================   ",
    "  =====================================-         ...              .:-=============================  ",
    " ======================================.         -===--:.           ..-============================ ",
    " =====================================-         .-========-..         .-=========================== ",
    " =====================================:        .:===========-.         .============================",
    "=====================================-.        .-============:          -===========================",
    "=====================================:.        :=============.          -===========================",
    "====================================-..        -============:          .============================",
    "====================================-.         .....::--::...         .=============================",
    "====================================.                               ..-=============================",
    "===================================-         ..                  ..:-===============================",
    "===================================.        .-==---:..           .:=================================",
    "==================================-.        .-========-:..          .===============================",
    "==================================:.       .:============-..         .-=============================",
    "=================================-.        .-==============:.         :=============================",
    "==========================-::--=-.         :===============-.         .=============================",
    " =========================.               .-===============:.         .=============================",
    " ========================:                .--=============:.          :============================ ",
    " =======================:...                    ..:::::..           ..-============================ ",
    "  =========================--::...                                  .-============================  ",
    "   ===============================-.                               .-============================   ",
    "    ==============================-.    :=-:..                  ..-=============================    ",
    "    ==============================:.    -===-.    .::.........:-================================    ",
    "     ============================-.    .====:.    -============================================     ",
    "      ===========================:    .-===-.    .============================================      ",
    "        =========================-:....====:    .-===========================================       ",
    "        ===================================..   .-==========================================        ",
    "          ======================================-=========================================          ",
    "           ==============================================================================           ",
    "             ==========================================================================             ",
    "               ======================================================================               ",
    "                 ==================================================================                 ",
    "                   ==============================================================                   ",
    "                      ========================================================                      ",
    "                        ====================================================                        ",
    "                           ==============================================                           ",
    "                                 ==================================                                 ",
    "                                      ========================                                      "
};
int art_lines = sizeof(ascii_art) / sizeof(ascii_art[0]);

void clear_buffer(char buffer[HEIGHT][WIDTH]) {
    for (int y = 0; y < HEIGHT; y++)
        for (int x = 0; x < WIDTH; x++)
            buffer[y][x] = ' ';
}

void draw(char buffer[HEIGHT][WIDTH]) {
    printf("\033[H");
    for (int y = 0; y < HEIGHT; y++) {
        for (int x = 0; x < WIDTH; x++)
            putchar(buffer[y][x]);
        putchar('\n');
    }
}

void rotate_point(float cx, float cy, float x, float y, float angle_deg, int *rx, int *ry) {
    float angle = angle_deg * PI / 180.0;
    float s = sin(angle);
    float c = cos(angle);

    x -= cx;
    y -= cy;

    float xnew = x * c - y * s;
    float ynew = x * s + y * c;

    x = xnew + cx;
    y = ynew + cy;

    *rx = (int)(x + 0.5);
    *ry = (int)(y + 0.5);
}

int main() {
    float angle = 0;

    int max_line_length = 0;
    for (int i = 0; i < art_lines; i++) {
        int len = strlen(ascii_art[i]);
        if (len > max_line_length) max_line_length = len;
    }
    float cx = max_line_length / 2.0;
    float cy = art_lines / 2.0;

    while (1) {
        char buffer[HEIGHT][WIDTH];
        clear_buffer(buffer);

        for (int y = 0; y < art_lines; y++) {
            for (int x = 0; x < strlen(ascii_art[y]); x++) {
                char ch = ascii_art[y][x];
                if (ch == ' ') continue;

                int rx, ry;
                rotate_point(cx, cy, x, y, angle, &rx, &ry);

                int screen_x = rx + (WIDTH / 2 - (int)cx);
                int screen_y = ry + (HEIGHT / 2 - (int)cy);

                if (screen_x >= 0 && screen_x < WIDTH &&
                    screen_y >= 0 && screen_y < HEIGHT) {
                    buffer[screen_y][screen_x] = ch;
                }
            }
        }

        draw(buffer);
        usleep(40000);
        angle += 3;
        if (angle >= 360) angle -= 360;
    }

    return 0;
}
